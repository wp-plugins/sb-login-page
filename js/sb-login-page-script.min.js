(function(e){(function(){e(".sb-login-form input, .sb-signup-form input, .sb-lost-password-form input").on("keyup",function(t){t.preventDefault();var n=e(this),r=n.closest("form");r.find(".errors").removeClass("active")});e(".sb-user-profile input").on("keyup",function(t){t.preventDefault();var n=e(this);n.parent().find(".notification").html("")})})();(function(){e(".sb-user-profile .btn-save").attr("disabled","disabled");e(".sb-user-profile").on("keyup",function(t){t.preventDefault();var n=e(this),r=n.find(".btn-save");r.removeAttr("disabled")});e(".sb-user-profile select").on("change",function(t){t.preventDefault();var n=e(this),r=n.closest("div.sb-user-profile"),i=r.find(".btn-save");i.removeAttr("disabled")});e(".sb-user-profile .btn-save").on("click",function(t){t.preventDefault();var n=e(this),r=n.closest("div.content-inner"),i=true,s=parseInt(n.attr("data-id")),o=null;if(n.hasClass("save-account")){var u=r.find(".user-email");if(!e.trim(u.val())){u.focus();i=false}if(i){e.ajax({type:"POST",dataType:"json",url:sb_core_ajax.url,data:{action:"sb_login_page_change_email",id:s,email:u.val(),security:e("#security").val()},success:function(e){var t=e;if(t.updated==true){window.location.href=window.location.href}else{u.parent().find(".notification").html(t.message)}}})}}else if(n.hasClass("btn-save-password")){var a=r.find(".user-current-password"),f=r.find(".user-password"),l=r.find(".re-password"),i=true;if(!e.trim(f.val())){f.focus();i=false}else if(!e.trim(f.val())){f.focus();i=false}else if(!e.trim(l.val())||l.val()!=f.val()){l.focus();i=false}if(i){e.ajax({type:"POST",dataType:"json",url:sb_core_ajax.url,data:{action:"sb_login_page_change_password",current_password:a.val(),new_password:f.val(),re_new_password:l.val(),id:s,security:e("#security").val()},success:function(e){var t=e;if(t.updated==true){window.location.href=window.location.href}else{if(t.field=="current_password"){a.focus();a.parent().find(".notification").html(t.message)}else if(t.field=="new_password"){f.focus();f.parent().find(".notification").html(t.message)}else if(t.field=="re_new_password"){l.focus();l.parent().find(".notification").html(t.message)}}}})}}else if(n.hasClass("save-personal-info")){var c=r.find(".user-name"),h=r.find(".user-gender"),p=r.find(".user-birth-day"),d=r.find(".user-birth-month"),v=r.find(".user-birth-year"),m=r.find(".user-phone"),g=r.find(".user-identity"),y=r.find(".user-address"),i=true;if(!e.trim(c.val())){c.focus();i=false}else if(!e.trim(m.val())){m.focus();i=false}else if(!e.trim(g.val())){g.focus();i=false}else if(!e.trim(y.val())){y.focus();i=false}if(i){e.ajax({type:"POST",dataType:"json",url:sb_core_ajax.url,data:{action:"sb_login_page_change_personal_info",user_name:c.val(),user_gender:h.val(),user_birth_day:p.val(),user_birth_month:d.val(),user_birth_year:v.val(),user_phone:m.val(),user_identity:g.val(),user_address:y.val(),id:s,security:e("#security").val()},success:function(e){window.location.href=window.location.href}})}}})})();(function(){e(".sb-user-profile .current-password").on("keyup",function(t){var n=e(this),r=n.find("input.user-current-password"),i=n.closest("div.content-inner");if(r.val().length>0){i.find(".main-password, .re-password").removeAttr("disabled")}else{i.find(".main-password, .re-password").attr("disabled","disabled")}})})();(function(){e(".sb-signup-form").on("submit",function(t){var n=e(this),r=n.find(".signup-fullname"),i=n.find(".signup-email"),s=n.find(".signup-phone"),o=n.find(".signup-address"),u=n.find(".signup-password"),a=n.find(".signup-password-2"),f=n.find(".errors"),l=n.find(".hidden-fields"),c=n.find(".success-field"),h=n.find(".signup-captcha"),p=true,d=null;if(!e.trim(i.val())){i.focus();p=false}else if(r.hasClass("must-have")&&!e.trim(r.val())){r.focus();p=false}else if(s.hasClass("must-have")&&!e.trim(s.val())){s.focus();p=false}else if(o.hasClass("must-have")&&!e.trim(o.val())){o.focus();p=false}else if(!e.trim(u.val())){u.focus();p=false}else if(!e.trim(a.val())){a.focus();p=false}else if(a.val()!=u.val()){a.focus();p=false}else if(h.length&&!e.trim(h.val())){h.focus();p=false}if(p){if(!c.length||parseInt(c.val())!=1){t.preventDefault()}e.ajax({type:"POST",dataType:"json",url:sb_core_ajax.url,data:{action:"sb_login_page_signup",email:i.val(),password:u.val(),name:r.val(),phone:s.val(),address:o.val(),security:n.find("#security").val(),captcha:h.val()},success:function(e){var t=e;if(t.valid==1){l.append(t.success_field);n.submit()}else{f.html(t.message);f.addClass("active")}}})}else{t.preventDefault()}})})();(function(){e(".sb-login-form").on("submit",function(t){var n=e(this),r=n.find(".login-email"),i=n.find(".login-password"),s=n.find(".redirect"),o=n.find(".login-submit"),u=n.find(".login-remember"),a=n.find(".errors"),f=true;t.preventDefault();if(!e.trim(r.val())){r.focus();f=false}else if(!e.trim(i.val())){i.focus();f=false}if(f){o.addClass("disabled");e.ajax({type:"POST",dataType:"json",url:sb_core_ajax.url,data:{action:"sb_login_page_login",email:r.val(),password:i.val(),remember:u.val(),security:n.find("#security").val()},success:function(t){var n=t;if(n.logged_in==true){window.location.href=s.val()}else{if(e.trim(n.message)){o.removeClass("disabled");a.html(n.message);a.addClass("active");setTimeout(function(){window.location.href=n.redirect},3e3)}else{r.focus();o.removeClass("disabled");a.addClass("active")}}if(n.logged_in==false&&n.block_login==true){sb_core.sb_refresh()}}})}})})();(function(){e(".sb-lost-password-form").on("submit",function(t){var n=e(this),r=n.find(".login-email"),i=n.find(".redirect"),s=n.find(".login-submit"),o=n.find(".errors"),u=n.find(".user-id"),a=true;t.preventDefault();if(!e.trim(r.val())){r.focus();a=false}if(a){s.addClass("disabled");e.ajax({type:"POST",dataType:"json",url:sb_core_ajax.url,data:{action:"sb_login_page_lost_password",email:r.val(),security:n.find("#security").val()},success:function(e){var t=e;if(t.user_id>0){window.location.href=t.redirect}else{r.focus();s.removeClass("disabled");o.addClass("active")}}})}});e(".sb-lost-password-form.verify").on("submit",function(t){var n=e(this),r=n.find(".redirect"),i=n.find(".login-submit"),s=n.find(".activation-code"),o=n.find(".errors"),u=n.find(".user-id"),a=true;t.preventDefault();if(!e.trim(s.val())){s.focus();a=false}if(a){i.addClass("disabled");e.ajax({type:"POST",dataType:"json",url:sb_core_ajax.url,data:{action:"sb_login_page_verify_activation_code",code:s.val(),user_id:u.val(),security:n.find("#security").val()},success:function(e){var t=e;if(t.valid==true){window.location.href=t.redirect}else{s.focus();i.removeClass("disabled");o.addClass("active")}}})}});e(".sb-lost-password-form.reset").on("submit",function(t){var n=e(this),r=n.find(".redirect"),i=n.find(".login-submit"),s=n.find(".query-code"),o=n.find(".errors"),u=n.find(".user-id"),a=n.find(".reset-password"),f=n.find(".reset-password-2"),l=true,c=null;t.preventDefault();if(!e.trim(a.val())){a.focus();l=false}else if(!e.trim(f.val())||f.val()!=a.val()){f.focus();l=false}if(l){i.addClass("disabled");c={action:"sb_login_page_reset_password",code:s.val(),password:a.val(),user_id:u.val(),security:n.find("#security").val()};e.post(sb_core_ajax.url,c,function(t){t=e.parseJSON(t);if(t.updated){window.location.href=t.redirect}})}});e("body").on("keyup",function(t){var n=e(this),r=n.find(".sb-lost-password-form.reset");if(!r.length){t.preventDefault();return false}var i=r.find(".reset-password"),s=r.find(".reset-password-2"),o=r.find(".reset-password-strength"),u=r.find(".login-submit"),a=["admin"];sb_core.sb_password_strength(i,s,o,u,a)})})();(function(){e(".sb-verify-email-form").on("submit",function(t){t.preventDefault();var n=e(this),r=n.find(".activation-code"),i=true,s=n.find(".user-id"),o=n.find(".redirect"),u=null;if(!e.trim(r.val())){r.focus();i=false}if(i){u={action:"sb_login_page_verify_email",code:r.val(),security:n.find("#security").val(),id:s.val()};e.post(sb_core_ajax.url,u,function(e){e=parseInt(e);if(1==e){window.location.href=o.val()}else{r.focus();n.find(".errors").addClass("active")}})}})})();(function(){e("body").on("keyup",function(t){var n=e(this),r=n.find(".main-password"),i=n.find(".re-password"),s=n.find(".password-meter"),o=n.find(".btn-save-password"),u=["admin"];sb_core.sb_password_strength(r,i,s,o,u)})})()})(jQuery)